---
title: ä¸€æ–‡è¯¦è¿°YOLOV1-V5ç³»åˆ—
date: 2020-12-04 13:51:20
index_img: /images/yolo.png
tags:
---

â€‹	`YOLO`ç³»åˆ—åº”è¯¥åœ¨ç›®æ ‡æ£€æµ‹ä¸­å®¶å–»æˆ·æ™“ï¼Œä»Šå¤©é˜³å…‰æ˜åªšï¼Œè¶æ­¤å†™ä¸€ç¯‡é•¿æ–‡ï¼Œä¹Ÿæ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ï¼Œè¯¦ç»†æè¿°ä¸€ä¸‹`YOLO`ç³»åˆ—ä»¥åŠé‡Œé¢çš„ç»†èŠ‚ã€‚ï¼ˆ<font color="red">Let'sÂ  Go! ğŸ˜</font>ï¼‰

â€‹	é¦–å…ˆéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä»`YOLO V1` çš„é¢˜ç›® `You Only Look Once: Unified, Real-Time Object Detection` ï¼Œåœˆä¸‹é‡ç‚¹ï¼Œé¦–å…ˆæ˜¯`Unified`,  `YOLO`æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„ç½‘ç»œï¼Œæ²¡æœ‰region proposal çš„è¿™ä¸ªè¿‡ç¨‹ã€‚ï¼ˆregion proposal ä¸»è¦æ˜¯`R-CNN`ç³»åˆ—ä¸­ï¼Œé¦–å…ˆæå–çš„å¯èƒ½çš„ç›®æ ‡åŒºåŸŸ ï¼‰ï¼Œæ‰€ä»¥YOLO æ˜¯ä¸€ä¸ª`One-Stage` æ£€æµ‹ç½‘ç»œã€‚å…¶æ¬¡ï¼ŒYOLO å°†æ£€æµ‹ç»Ÿä¸€è§†ä¸ºä¸€ä¸ª**å›å½’**é—®é¢˜ï¼Œè€ŒR-CNN æŠŠæ£€æµ‹ç»“æœåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç‰©ä½“ç±»åˆ«çš„åˆ†ç±»ï¼Œå³æ£€æµ‹å‡ºæ¥çš„ç‰©ä½“æ˜¯å±äºå“ªä¸€ç±»ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰ï¼Œç‰©ä½“çš„å…·ä½“ä½ç½®ï¼Œå³Bounding box çš„åæ ‡ï¼ˆå›å½’é—®é¢˜ï¼‰ã€‚è¿™æ˜¯å¯¹äº`Unified`çš„ç†è§£ï¼Œå…¶æ¬¡æ˜¯`Real-Time`,å®æ—¶æ€§ï¼Œä¹Ÿå°±æ˜¯YOLOç³»åˆ—çš„æ£€æµ‹æ€§èƒ½ååˆ†é«˜æ•ˆï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚

## YOLO V1 

 [è®ºæ–‡é“¾æ¥][https://arxiv.org/pdf/1506.02640.pdf]

Yolo V1 å°†æ•´å¼ å›¾ç‰‡ä½œä¸ºç½‘ç»œçš„è¾“å…¥ï¼Œç›´æ¥åœ¨æœ€åçš„è¾“å‡ºå±‚å›å½’ Bounding Box çš„ä½ç½®ä»¥åŠç‰©ä½“æ‰€å±çš„ç±»åˆ«ã€‚

![YOLOV1_model](yolov1model.png)

â€‹	å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒæŠŠä¸€å¹…å›¾åƒåˆ†ä¸º `SÃ—S` ä¸ªç½‘æ ¼ï¼ˆgrid cellï¼‰, å¦‚æœæŸä¸ªç‰©ä½“çš„ä¸­å¿ƒè½åœ¨äº†è¿™ä¸ªæ ¼å­é‡Œï¼Œé‚£ä¹ˆè¿™ä¸ªæ ¼å­å°±è´Ÿè´£é¢„æµ‹è¿™ä¸ªç‰©ä½“ã€‚

â€‹	é¦–å…ˆç»™å‡ºä¸€ä¸ªå…¬å¼ï¼Œå¯¹äºæ¯å¼ å›¾åƒï¼Œè¾“å‡º`SÃ—SÃ—(5Ã—B+C)` è¿™æ ·çš„ä¸€ä¸ªtensor ã€‚

â€‹	æ¥ä¸‹æ¥å…·ä½“ç†è§£ä¸€ä¸‹è¿™ä¸ªå…¬å¼: 

   `SÃ—S`, è¿™æ˜¯ä¸€å…±æœ‰è¿™ä¹ˆå¤šä¸ªç½‘æ ¼ï¼›

â€‹	5 ä¸ªæ˜¯ ï¼ˆ4+1ï¼‰ä¸ªæ„æˆï¼š

â€‹    `4`ä¸ª ä»£è¡¨ç€BBoxä¿¡æ¯ï¼Œå³`(x, y, w, h)`, x, y æ˜¯ç‰©ä½“çš„ä¸­å¿ƒï¼Œw,h æ˜¯ç‰©ä½“çš„å®½åº¦å’Œé«˜åº¦ï¼›

  ï¼ˆæ³¨æ„ ï¼šYOLOç³»åˆ—çš„æ•°æ®å½¢å¼éƒ½æ˜¯x y w h, å³ä¸­å¿ƒç‚¹åæ ‡å’Œå®½é«˜ï¼› R-CNNç³»åˆ—çš„åˆ™æ˜¯x y x yï¼Œå³å·¦ä¸Šè§’å’Œå³ä¸‹è§’çš„åæ ‡ã€‚ï¼‰

â€‹	`	1`  ä¸ªä»£è¡¨çš„æ˜¯ç½®ä¿¡åº¦ï¼Œconfidenceè®¡ç®—æ–¹æ³•: $\operatorname{Pr}($ Object $) * \mathrm{IOU}_{\text {pred }}^{\text {truth }}$,  ç¬¬ä¸€é¡¹æŒ‡çš„æ˜¯ç‰©ä½“æ˜¯å¦è½åœ¨è¯¥ç½‘æ ¼é‡Œï¼Œå¦‚æœæ²¡æœ‰å–0ï¼Œå¦‚æœåœ¨ï¼Œå–1ï¼›ç¬¬äºŒé¡¹æŒ‡çš„æ˜¯é¢„æµ‹çš„ BBox å’Œ Ground-truthçš„ IoU å¤§å°ã€‚ä¸¤è€…ç›¸ä¹˜å°±æ˜¯ confidence. IoU æŒ‡çš„æ˜¯ä¸¤ä¸ªçŸ©å½¢æ¡†çš„äº¤å¹¶æ¯”ã€‚

åœ¨è¿™é‡Œï¼Œæ”¾ä¸€ä¸ªè®¡ç®— IoU çš„ä»£ç ï¼ˆå¬è¯´é¢è¯•å¸¸è€ƒï¼‰, æ–¹ä¾¿ç†è§£ï¼š

```python
def compute_IOU(rec1,rec2):
    """
    è®¡ç®—ä¸¤ä¸ªçŸ©å½¢æ¡†çš„äº¤å¹¶æ¯”ã€‚
    :param rec1: (x0,y0,x1,y1)      (x0,y0)ä»£è¡¨çŸ©å½¢å·¦ä¸Šçš„é¡¶ç‚¹ï¼Œï¼ˆx1,y1ï¼‰ä»£è¡¨çŸ©å½¢å³ä¸‹çš„é¡¶ç‚¹ã€‚ä¸‹åŒã€‚
    :param rec2: (x0,y0,x1,y1)
    :return: äº¤å¹¶æ¯”IOU.
    """
    left_column_max  = max(rec1[0],rec2[0])
    right_column_min = min(rec1[2],rec2[2])
    up_row_max       = max(rec1[1],rec2[1])
    down_row_min     = min(rec1[3],rec2[3])
    #ä¸¤çŸ©å½¢æ— ç›¸äº¤åŒºåŸŸçš„æƒ…å†µ
    if left_column_max>=right_column_min or down_row_min<=up_row_max:
        return 0
    # ä¸¤çŸ©å½¢æœ‰ç›¸äº¤åŒºåŸŸçš„æƒ…å†µ
    else:
        S1 = (rec1[2]-rec1[0])*(rec1[3]-rec1[1])
        S2 = (rec2[2]-rec2[0])*(rec2[3]-rec2[1])
        S_cross = (down_row_min-up_row_max)*(right_column_min-left_column_max)
        return S_cross/(S1+S2-S_cross)
```

B æŒ‡çš„æ˜¯ä¸€ä¸ªç½‘æ ¼é¢„æµ‹ B ä¸ªBBoxï¼› CæŒ‡çš„æ˜¯ç‰©ä½“çš„ç±»åˆ«ï¼›

ä¸¾ä¸ªä¾‹å­ï¼Œè®ºæ–‡é‡Œå¯¹äºYOLOåœ¨PASCAL VOCä¸­ çš„å®éªŒï¼ŒS = 7, B = 2, C = 20,  å› æ­¤å°±æ˜¯è¾“å‡º7 Ã— 7 Ã— 30 çš„tensorã€‚

![YOLOV1_model](yolov1framework.png)

**æ³¨æ„:**  è¿™é‡ŒB = 2 æ˜¯ä¸€ä¸ªå¯è°ƒèŠ‚çš„ å‚æ•°ï¼Œå¦‚æœB = 2ï¼Œ æ¯ä¸ªç½‘æ ¼äº§ç”Ÿä¸¤ä¸ªé¢„æµ‹æ¡†ï¼Œæœ€ååªé€‰å®šç½®ä¿¡åº¦è¾ƒå¤§çš„ä½œä¸ºè¾“å‡ºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€ç»ˆæ¯ä¸ªæ–¹æ ¼åªè¾“å‡ºä¸€ä¸ªé¢„æµ‹æ¡†ï¼Œæ‰€ä»¥æ¯ä¸ªæ–¹æ ¼åªèƒ½é¢„æµ‹ä¸€ä¸ªç‰©ä½“ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç‰©ä½“çš„ä¸­å¿ƒè½åœ¨äº†ä¸€ä¸ªå°ç½‘æ ¼é‡Œé¢ï¼Œé‚£ä¹ˆè¯¥ç½‘æ ¼ä¹Ÿæ˜¯åªèƒ½é¢„æµ‹ä¸€ä¸ªç‰©ä½“ï¼Œè¿™ç§æƒ…å†µä¼šå‡ºç°æ¼æ£€ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥å›¾åƒï¼Œåªèƒ½é¢„æµ‹å‡º S Ã— S ä¸ªç‰©ä½“ã€‚ï¼ˆå½“ç„¶ï¼ŒSä¹Ÿæ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚ï¼‰ 

â€‹	åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œæ¯ä¸ªç½‘ç»œé¢„æµ‹çš„classæ¦‚ç‡å’ŒBBoxçš„confidenceæ¦‚ç‡ç›¸ä¹˜ï¼Œå¾—åˆ°è¯¥BBoxçš„ class-specific confidence score

è®¡ç®—å…¬å¼ï¼š
$$
\operatorname{Pr}\left(\text { Class }_{i} \mid \text { Object }\right) * \operatorname{Pr}(\text { Object }) * \mathrm{IOU}_{\text {pred }}^{\text {truth }}=\operatorname{Pr}\left(\text { Class }_{i}\right) * \mathrm{IOU}_{\text {pred }}^{\text {truth }}
$$
â€‹	æ¥ç€æ˜¯ **éæå¤§å€¼æŠ‘åˆ¶(NMS)**, NMS ç”¨æ¥å»é™¤å†—ä½™çš„é‡å æ¡†ï¼Œ

![NMS](nms.png)

NMSç®—æ³•æµç¨‹ï¼š

   ç»™å‡ºä¸€å¼ å›¾ç‰‡å’Œä¸Šé¢è®¸å¤šç‰©ä½“æ£€æµ‹çš„å€™é€‰æ¡†ï¼ˆå³æ¯ä¸ªæ¡†å¯èƒ½éƒ½ä»£è¡¨æŸç§ç‰©ä½“ï¼‰ï¼Œä½†æ˜¯è¿™äº›æ¡†å¾ˆå¯èƒ½æœ‰äº’ç›¸é‡å çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯åªä¿ç•™æœ€ä¼˜çš„æ¡†ã€‚å‡è®¾æœ‰`N`ä¸ªæ¡†ï¼Œæ¯ä¸ªæ¡†è¢«åˆ†ç±»å™¨è®¡ç®—å¾—åˆ°çš„åˆ†æ•°ä¸º`Si, 1<=i<=N`

1. å»ºé€ ä¸€ä¸ªå­˜æ”¾å¾…å¤„ç†å€™é€‰æ¡†çš„é›†åˆHï¼Œåˆå§‹åŒ–ä¸ºåŒ…å«å…¨éƒ¨Nä¸ªæ¡†ï¼›å»ºé€ ä¸€ä¸ªå­˜æ”¾æœ€ä¼˜æ¡†çš„é›†åˆMï¼Œåˆå§‹åŒ–ä¸ºç©ºé›†
2. å°†æ‰€æœ‰é›†åˆ H ä¸­çš„æ¡†è¿›è¡Œæ’åºï¼Œé€‰å‡ºåˆ†æ•°æœ€é«˜çš„æ¡† mï¼Œä»é›†åˆ H ç§»åˆ°é›†åˆ M
3. éå†é›†åˆ H ä¸­çš„æ¡†ï¼Œåˆ†åˆ«ä¸æ¡†mè®¡ç®—äº¤å¹¶æ¯”ï¼ˆIoUï¼‰ï¼Œå¦‚æœé«˜äºæŸä¸ªé˜ˆå€¼ï¼ˆä¸€èˆ¬ä¸º0.3~0.5ï¼‰ï¼Œåˆ™è®¤ä¸ºæ­¤æ¡†ä¸mé‡å ï¼Œå°†æ­¤æ¡†ä»é›†åˆ H ä¸­å»é™¤.
4. å›åˆ°ç¬¬2æ­¥è¿›è¡Œè¿­ä»£ï¼Œç›´åˆ°é›†åˆ H ä¸ºç©ºã€‚é›†åˆ M ä¸­çš„æ¡†ä¸ºæˆ‘ä»¬æ‰€éœ€ã€‚

ä¸ºä¾¿äºç†è§£ï¼Œæ”¾ä¸€ä¸ªç”¨ `numpy` å†™çš„NMSä»£ç ï¼š 

```python
import numpy as np

def NMS(dets, thresh):

    #x1ã€y1ã€x2ã€y2ã€ä»¥åŠscoreèµ‹å€¼
    # ï¼ˆx1ã€y1ï¼‰ï¼ˆx2ã€y2ï¼‰ä¸ºboxçš„å·¦ä¸Šå’Œå³ä¸‹è§’æ ‡
    x1 = dets[:, 0]
    y1 = dets[:, 1]
    x2 = dets[:, 2]
    y2 = dets[:, 3]
    scores = dets[:, 4]


    #æ¯ä¸€ä¸ªå€™é€‰æ¡†çš„é¢ç§¯
    areas = (x2 - x1 + 1) * (y2 - y1 + 1)
    #orderæ˜¯æŒ‰ç…§scoreé™åºæ’åºçš„ï¼Œå¾—åˆ°çš„æ˜¯æ’åºçš„æœ¬æ¥çš„ç´¢å¼•ï¼Œä¸æ˜¯æ’å®Œåºçš„åŸæ•°ç»„
    order = scores.argsort()[::-1]
    # ::-1è¡¨ç¤ºé€†åº

    temp = []
    while order.size > 0:
        i = order[0]
        temp.append(i)
        #è®¡ç®—å½“å‰æ¦‚ç‡æœ€å¤§çŸ©å½¢æ¡†ä¸å…¶ä»–çŸ©å½¢æ¡†çš„ç›¸äº¤æ¡†çš„åæ ‡
        # ç”±äºnumpyçš„broadcastæœºåˆ¶ï¼Œå¾—åˆ°çš„æ˜¯å‘é‡
        xx1 = np.maximum(x1[i], x1[order[1:]])
        yy1 = np.minimum(y1[i], y1[order[1:]])
        xx2 = np.minimum(x2[i], x2[order[1:]])
        yy2 = np.maximum(y2[i], y2[order[1:]])

        #è®¡ç®—ç›¸äº¤æ¡†çš„é¢ç§¯,æ³¨æ„çŸ©å½¢æ¡†ä¸ç›¸äº¤æ—¶wæˆ–hç®—å‡ºæ¥ä¼šæ˜¯è´Ÿæ•°ï¼Œéœ€è¦ç”¨0ä»£æ›¿
        w = np.maximum(0.0, xx2 - xx1 + 1)
        h = np.maximum(0.0, yy2 - yy1 + 1)
        inter = w * h
        #è®¡ç®—é‡å åº¦IoU
        ovr = inter / (areas[i] + areas[order[1:]] - inter)

        #æ‰¾åˆ°é‡å åº¦ä¸é«˜äºé˜ˆå€¼çš„çŸ©å½¢æ¡†ç´¢å¼•
        inds = np.where(ovr <= thresh)[0]
        #å°†orderåºåˆ—æ›´æ–°ï¼Œç”±äºå‰é¢å¾—åˆ°çš„çŸ©å½¢æ¡†ç´¢å¼•è¦æ¯”çŸ©å½¢æ¡†åœ¨åŸorderåºåˆ—ä¸­çš„ç´¢å¼•å°1ï¼Œæ‰€ä»¥è¦æŠŠè¿™ä¸ª1åŠ å›æ¥
        order = order[inds + 1]
    return temp


if __name__ == "__main__":
    dets = np.array([[310, 30, 420, 50, 0.6],
                     [20, 20, 240, 210, 1],
                     [70, 50, 260, 220, 0.8],
                     [400, 280, 560, 360, 0.7]])
    # è®¾ç½®é˜ˆå€¼
    thresh = 0.4
    keep_dets = NMS(dets, thresh)
    # æ‰“å°ç•™ä¸‹çš„æ¡†çš„ç´¢å¼•
    print(keep_dets)
    # æ‰“å°ç•™ä¸‹çš„æ¡†çš„ä¿¡æ¯
    print(dets[keep_dets])
```

  æœ€åæˆ‘ä»¬çœ‹ä¸€ä¸‹YOLO V1 ä¸­è®­ç»ƒçš„**æŸå¤±å‡½æ•°**:

![loss](yolov1loss.png)

æˆ‘ä»¬æ·±å…¥æ¢è®¨ç†è§£ä¸€ä¸‹è¿™ä¸ªçœ‹èµ·æ¥å¾ˆå¤æ‚çš„ä»£ä»·å‡½æ•°ï¼š

1. é¦–å…ˆï¼Œç¬¬ä¸€è¡Œæ˜¯é¢„æµ‹æ¡†ä¸­å¿ƒç‚¹çš„çº¦æŸï¼Œ$\mathbb{1}_{i j}^{\mathrm{obj}}$  æ˜¯ä¸€ä¸ªæ§åˆ¶å‡½æ•°ï¼Œæ ‡ç­¾ä¸­åŒ…å«ç‰©ä½“çš„é‚£äº›ç½‘æ ¼ï¼Œå€¼ä¸º1ï¼Œå¦åˆ™ä¸º 0ï¼Œåªå¯¹çœŸæ­£æœ‰ç‰©ä½“çš„ç½‘æ ¼åšæŸå¤±è®¡ç®—ã€‚
2. ç¬¬äºŒè¡Œæ˜¯é¢„æµ‹æ¡†çš„å®½é«˜çš„çº¦æŸï¼Œæˆ‘ä»¬æ³¨æ„çœ‹ è¿™é‡Œå¤šäº†ä¸ªæ ¹å·ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ è¿™æ˜¯æ¯”è¾ƒå·§å¦™çš„ä¸€ç§åšæ³•ï¼Œæ—¨åœ¨æ¶ˆé™¤å¤§å°ºå¯¸å’Œå°å°ºå¯¸çš„æ¡†ä¹‹é—´çš„å·®å¼‚ï¼Œæ¯”å¦‚åŒæ ·æ˜¯10ä¸ªåƒç´ çš„è¯¯å·®ï¼Œå¯¹äºå‡ ç™¾ä¹˜å‡ ç™¾çš„å¤§ç‰©ä½“æ¡†ï¼Œå‡ ä¹æ²¡æœ‰å½±å“ï¼Œä½†æ˜¯å¯¹äºæœ¬èº«å°±åªæœ‰å‡ ååƒç´ çš„æ¡†ï¼Œå½±å“åˆ™éå¸¸å¤§ã€‚å› æ­¤å¦‚æœä¸å¼€æ ¹å·ï¼Œè®­ç»ƒè¿‡ç¨‹å¾€å¾€ä¼šåªä¼˜åŒ–è°ƒæ•´é‚£äº›å°ºå¯¸æ¯”è¾ƒå¤§çš„æ¡†ã€‚
3. ç¬¬ä¸‰è¡Œå’Œç¬¬å››è¡Œéƒ½æ˜¯å¯¹é¢„æµ‹æ¡†ç½®ä¿¡åº¦çš„çº¦æŸï¼Œ å½“è¯¥ç½‘æ ¼ä¸­å«æœ‰ç‰©ä½“çš„æ—¶å€™ï¼Œç½®ä¿¡åº¦çš„ gt ä¸º é¢„æµ‹æ¡†ä¸çœŸå®æ¡†çš„ IoU, æ²¡æœ‰ç‰©ä½“æ—¶ï¼Œç½®ä¿¡åº¦çš„ gt ä¸º0ã€‚
4. ç¬¬äº”è¡Œ ä¸º ç‰©ä½“ç±»åˆ« çš„çº¦æŸï¼Œå¯¹åº”çš„ç±»åˆ«ä½ç½®gtä¸º1ï¼Œå…¶ä½™ä½ç½®ä¸º0ã€‚

è¿™é‡Œæœ‰ä¸¤ä¸ªç³»æ•°ï¼Œ$$\lambda_{coord}$$   $$\lambda_{noobj}$$ï¼Œå‰è€…è®ºæ–‡ä¸­ä¸º5ï¼Œåè€…è®ºæ–‡ä¸­è®¾ä¸º0.5ï¼Œ

 å› ä¸ºç‰©ä½“æ£€æµ‹å…¶å®æ˜¯ç±»åˆ«ä¸å‡è¡¡çš„é—®é¢˜ï¼Œåªæœ‰å°‘æ•°ç½‘æ ¼æœ‰ç‰©ä½“ï¼Œå› æ­¤å¦‚æœä¸è¿›è¡Œæƒé‡çº¦æŸï¼Œç½‘ç»œä¼šå€¾å‘äºçº¦æŸä¸å«æœ‰ç‰©ä½“çš„æ ¼ç‚¹ï¼Œä½†æˆ‘ä»¬æ›´æƒ³è¦çš„æ˜¯çº¦æŸå«æœ‰ç‰©ä½“çš„ç½‘æ ¼é¢„æµ‹çš„æ›´å‡†ç¡®ã€‚å› æ­¤é‡‡å–è¿™æ ·ä¸€ä¸ªæƒé‡çº¦æŸã€‚

**è®­ç»ƒæŠ€å·§ï¼š** x, y ä¸æ˜¯ç›´æ¥å›å½’ä¸­å¿ƒç‚¹åæ ‡çš„æ•°å€¼ï¼Œè€Œæ˜¯å›å½’ç›¸å¯¹äºç½‘æ ¼ç‚¹å·¦ä¸Šè§’åæ ‡çš„ä½ç§»å€¼ã€‚

è¯»åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹YOLO V1 åº”è¯¥æœ‰ä¸€ä¸ªè¾ƒä¸ºå…¨é¢è¯¦ç»†çš„äº†è§£äº†å§~~ğŸ¤­

**------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------**

## YOLO V2

[è®ºæ–‡é“¾æ¥][https://arxiv.org/pdf/1612.08242.pdf]

äº†è§£å®ŒYOLO V1ï¼Œå’±ä»¬æ¥çœ‹çœ‹å°é©¬å“¥çš„YOLO V2ï¼Œï¼ˆè‡³äºä¸ºä»€ä¹ˆå«å°ğŸå“¥ï¼Œå»YOLOå®˜ç½‘çœ‹çœ‹å¤§ä½¬çš„ç®€å†å°±çŸ¥é“äº†å“ˆå“ˆå“ˆï¼‰

â€‹		å‰é¢è¯´åˆ°YOLO V1 çš„ `unified`,  `real-time`ï¼Œ ä½†ä¹Ÿæœ‰ä¸è¶³ä¹‹å¤„ï¼Œå°±æ˜¯å› ä¸ºæ¼æ£€å‘¢ï¼Œå¬å›ç‡ä¼šæ¯”è¾ƒä½ã€‚YOLO V2 å¯¹ YOLO V1è¿›è¡Œäº†å¾ˆå¤šæ”¹è¿›ã€‚å…ˆè¯´è¯´è®ºæ–‡é¢˜ç›®æ€ä¹ˆå« YOLO9000ï¼Œ YOLO 9000 æ˜¯é‡‡ç”¨äº†å’Œ YOLO V2 ä¸€æ ·çš„æ¨¡å‹ï¼Œ åœ¨COCO å’Œ ImageNet ä¸Šä¸€èµ·è®­ç»ƒï¼Œä½¿å¾—è®­ç»ƒåçš„æ¨¡å‹å¯ä»¥å®ç°å¤šè¾¾9000ç§ç‰©ä½“çš„å®æ—¶æ£€æµ‹ã€‚

**YOLO V2 çš„æ”¹è¿›ä¹‹å¤„:**

å…ˆçœ‹çœ‹è®ºæ–‡é‡Œè¿™ä¸ªä»YOLO V1 åˆ° YOLO V2çš„è·¯çº¿å›¾ï¼š

![the path from YOLO to YOLO V2](yolov2path.png)

â‘  Batch norm:  è¿™é‡Œå…ˆç®€å•ä»‹ç»ä¸€äº›Batch norm, åé¢ä¼šæœ‰æ–‡ç« ä¸“é—¨ä»‹ç»å„ç§ norm; 

â€‹	CNNåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç½‘ç»œæ¯å±‚è¾“å…¥çš„åˆ†å¸ƒä¸€ç›´åœ¨æ”¹å˜, ä¼šä½¿è®­ç»ƒè¿‡ç¨‹éš¾åº¦åŠ å¤§ï¼Œä½†å¯ä»¥é€šè¿‡normalizeæ¯å±‚çš„è¾“å…¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…·ä½“åšæ³•æ˜¯: æ•°æ®çš„è¾“å…¥å€¼å‡å»å…¶å‡å€¼ç„¶åé™¤ä»¥æ•°æ®çš„æ ‡å‡†å·®ï¼Œç„¶åå¼•å…¥ä¸€ä¸ªå¹³ç§»å˜é‡å’Œç¼©æ”¾å˜é‡ï¼Œå†è®¡ç®—å½’ä¸€åŒ–çš„å€¼ã€‚

é€šè¿‡ BNï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° mAP å¾—åˆ°äº†`2.2` ä¸ªç‚¹çš„æé«˜ã€‚

â‘¡  High Resolution Classifier: å‡ ä¹æ‰€æœ‰çš„æ£€æµ‹å™¨éƒ½ä¼šä½¿ç”¨åœ¨ ImageNet ä¸Šé¢„è®­ç»ƒçš„åˆ†ç±»å™¨ï¼ŒYOLO V1 ä¸­ç”¨`224 Ã— 224` çš„å›¾ç‰‡æ¥é¢„è®­ç»ƒåˆ†ç±»ç½‘ç»œï¼Œæ£€æµ‹æ—¶å¢å¤§åˆ†è¾¨ç‡è‡³ `448 Ã— 448`ï¼Œè¿™æ„å‘³ç€ç½‘ç»œä¸å¾—ä¸åŒæ—¶å­¦ä¹ æ£€æµ‹ä»»åŠ¡å’Œé€‚åº”æ–°çš„æ›´å¤§çš„åˆ†è¾¨ç‡ã€‚è€Œåœ¨YOLO V2 ä¸­ï¼Œä½œè€…å…ˆç›´æ¥ç”¨`448 Ã— 448`çš„åˆ†è¾¨ç‡åœ¨ ImageNet ä¸Šfinetune ï¼Œç„¶åä½œè€…å¯¹æ£€æµ‹ç½‘ç»œéƒ¨åˆ†ï¼ˆä¹Ÿå°±æ˜¯ååŠéƒ¨åˆ†ï¼‰ä¹Ÿè¿›è¡Œfine tuneï¼Œ è¿™ä¸ªæ“ä½œå¯ä»¥æå‡å¤§çº¦`4`ä¸ªç‚¹ã€‚

â‘¢ Convolutional With Anchor Boxesï¼šå¯¹äºAnchor Box å¯ä»¥ç†è§£ä¸ºé¢„å®šä¹‰çš„ä¸€äº›è¾¹æ¡†ï¼Œåœ¨YOLO ä¸­ï¼Œä½œè€…æ˜¯é€šè¿‡K-Means èšç±»æ¥å¾—åˆ°è¿™äº›è¾¹æ¡†ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ç»„æ•°:

```
anchors = 0.57273, 0.677385, 1.87446, 2.06253, 3.33843, 5.47434, 7.88282, 3.52778, 9.77052, 9.16828
```

å’¦ï¼ŸğŸ˜¯ æ€ä¹ˆæœ€å¤§çš„æ‰9ç‚¹å¤šï¼Ÿ è¿™æ˜¯ç›¸å¯¹äºæœ€åä¸€ä¸ªFeature map å¤§å°ï¼ŒYOLO V2 æ£€æµ‹æ—¶å€™è¾“å…¥å¤§å°ä¸º`416 Ã— 416`ï¼Œ é™é‡‡æ ·32å€ï¼Œå˜æˆ`13 Ã— 13`ã€‚